% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={hw2-tora},
  pdfauthor={Deepa, Tora},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{hw2-tora}
\author{Deepa, Tora}
\date{2022-09-26}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(pROC)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Type 'citation("pROC")' for a citation.
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'pROC'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     cov, smooth, var
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyr);}
\FunctionTok{library}\NormalTok{(dplyr); }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'dplyr'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     filter, lag
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(kableExtra);}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning in !is.null(rmarkdown::metadata$output) && rmarkdown::metadata$output
## %in% : 'length(x) = 2 > 1' in coercion to 'logical(1)'
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'kableExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     group_rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## Loading required package: lattice
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

\hypertarget{loaded-classification-data-set-from-github.}{%
\subsection{1. Loaded classification data set from
GitHub.}\label{loaded-classification-data-set-from-github.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"https://raw.githubusercontent.com/deepasharma06/Data621{-}HW2/main/classification{-}output{-}data.csv"}\NormalTok{)}
\FunctionTok{head}\NormalTok{(data) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{, }\StringTok{"condensed"}\NormalTok{), }\AttributeTok{full\_width =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{position =} \StringTok{"center"}\NormalTok{, }\AttributeTok{font\_size =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begingroup\fontsize{15}{17}\selectfont

\begin{tabu} to \linewidth {>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X>{\raggedleft}X}
\hline
pregnant & glucose & diastolic & skinfold & insulin & bmi & pedigree & age & class & scored.class & scored.probability\\
\hline
7 & 124 & 70 & 33 & 215 & 25.5 & 0.161 & 37 & 0 & 0 & 0.3284523\\
\hline
2 & 122 & 76 & 27 & 200 & 35.9 & 0.483 & 26 & 0 & 0 & 0.2731904\\
\hline
3 & 107 & 62 & 13 & 48 & 22.9 & 0.678 & 23 & 1 & 0 & 0.1096604\\
\hline
1 & 91 & 64 & 24 & 0 & 29.2 & 0.192 & 21 & 0 & 0 & 0.0559984\\
\hline
4 & 83 & 86 & 19 & 0 & 29.3 & 0.317 & 34 & 0 & 0 & 0.1004907\\
\hline
1 & 100 & 74 & 12 & 46 & 19.5 & 0.149 & 28 & 0 & 0 & 0.0551546\\
\hline
\end{tabu}
\endgroup{}

\hypertarget{the-data-set-has-three-key-columns-we-will-use}{%
\section{2. The data set has three key columns we will
use:}\label{the-data-set-has-three-key-columns-we-will-use}}

class: the actual class for the observation scored.class: the predicted
class for the observation (based on a threshold of 0.5)
scored.probability: the predicted probability of success for the
observation

Use the table() function to get the raw confusion matrix for this scored
dataset. Make sure you understand the output. In particular, do the rows
represent the actual or predicted class? The columns?

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#row: predicted value; columns: actual value}
\NormalTok{conf\_matrix }\OtherTok{=} \FunctionTok{table}\NormalTok{(}\AttributeTok{Prediction =}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{scored.class, }\AttributeTok{Actual =}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{class)}
\NormalTok{conf\_matrix }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{bootstrap\_options =} \FunctionTok{c}\NormalTok{(}\StringTok{"striped"}\NormalTok{, }\StringTok{"hover"}\NormalTok{, }\StringTok{"condensed"}\NormalTok{), }\AttributeTok{full\_width =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{position =} \StringTok{"center"}\NormalTok{, }\AttributeTok{font\_size =} \DecValTok{15}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begingroup\fontsize{15}{17}\selectfont

\begin{tabu} to \linewidth {>{\raggedright}X>{\raggedleft}X>{\raggedleft}X}
\hline
  & 0 & 1\\
\hline
0 & 119 & 30\\
\hline
1 & 5 & 27\\
\hline
\end{tabu}
\endgroup{}

\hypertarget{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified}{%
\subsection{3. Write a function that takes the data set as a dataframe,
with actual and predicted classifications
identified,}\label{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified}}

\begin{verbatim}
 and returns the accuracy of the predictions.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{accuracy }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
  
\NormalTok{  conf }\OtherTok{=} \FunctionTok{table}\NormalTok{(data[ , predicted\_col\_name], data[ , actual\_col\_name])}
\NormalTok{  TP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\NormalTok{  TN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\#Accurary = (TP + TN) / (TP + FP +TN +FN)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{round}\NormalTok{((TP}\SpecialCharTok{+}\NormalTok{TN)}\SpecialCharTok{/}\NormalTok{(TP }\SpecialCharTok{+}\NormalTok{ FP }\SpecialCharTok{+}\NormalTok{ TN }\SpecialCharTok{+}\NormalTok{ FN), }\DecValTok{4}\NormalTok{))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-1}{%
\subsection{4.Write a function that takes the data set as a dataframe,
with actual and predicted classifications
identified,}\label{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-1}}

and returns the classification error rate of the predictions.

Verify that you get an accuracy and an error rate that sums to one

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{errorRate }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
  
\NormalTok{  conf }\OtherTok{=} \FunctionTok{table}\NormalTok{(data[ , predicted\_col\_name], data[ , actual\_col\_name])}
\NormalTok{  TP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\NormalTok{  TN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\#Classification Error Rate = ( FP + FN )/(TP + FP +TN +FN)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{round}\NormalTok{((FP}\SpecialCharTok{+}\NormalTok{FN)}\SpecialCharTok{/}\NormalTok{(TP }\SpecialCharTok{+}\NormalTok{ FP }\SpecialCharTok{+}\NormalTok{ TN }\SpecialCharTok{+}\NormalTok{ FN), }\DecValTok{4}\NormalTok{))}
\NormalTok{\}}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Error rate: "}\NormalTok{, }\FunctionTok{errorRate}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Error rate: 0.1934"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#accuracy + error rate}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Accuracy + Error rate = "}\NormalTok{, }\FunctionTok{accuracy}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{), }\StringTok{" + "}\NormalTok{, }\FunctionTok{errorRate}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{), }\StringTok{" = "}\NormalTok{, (}\FunctionTok{accuracy}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{) }\SpecialCharTok{+} \FunctionTok{errorRate}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{))))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Accuracy + Error rate = 0.8066 + 0.1934 = 1"
\end{verbatim}

\#5 Write a function that takes the data set as a dataframe, with actual
and predicted classifications identified, and returns the precision of
the predictions.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{precision }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
  
\NormalTok{  conf }\OtherTok{=} \FunctionTok{table}\NormalTok{(data[ , predicted\_col\_name], data[ , actual\_col\_name])}
\NormalTok{  TP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\NormalTok{  TN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\#Precision = TP / (TP + FP)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{round}\NormalTok{((TP)}\SpecialCharTok{/}\NormalTok{(TP }\SpecialCharTok{+}\NormalTok{ FP), }\DecValTok{4}\NormalTok{))}
\NormalTok{\}}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Precision: "}\NormalTok{, }\FunctionTok{precision}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Precision: 0.8438"
\end{verbatim}

\hypertarget{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-and-returns-the-sens-of-the-predictions.-sensitivity-is-also-known-as-recall.}{%
\subsection{6. Write a function that takes the data set as a dataframe,
with actual and predicted classifications identified, and returns the
sens of the predictions. Sensitivity is also known as
recall.}\label{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-and-returns-the-sens-of-the-predictions.-sensitivity-is-also-known-as-recall.}}

Sensitivity = TP / (TP + FN)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sens }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
  
\NormalTok{  conf }\OtherTok{=} \FunctionTok{table}\NormalTok{(data[ , predicted\_col\_name], data[ , actual\_col\_name])}
\NormalTok{  TP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\NormalTok{  TN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\#Sensitivity = TP / (TP + FN)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{round}\NormalTok{((TP)}\SpecialCharTok{/}\NormalTok{(TP }\SpecialCharTok{+}\NormalTok{ FN), }\DecValTok{4}\NormalTok{))}
\NormalTok{\}}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Sensitivity: "}\NormalTok{, }\FunctionTok{sens}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Sensitivity: 0.4737"
\end{verbatim}

\hypertarget{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-and-returns-the-spec-of-the-predictions.}{%
\subsection{7. Write a function that takes the data set as a dataframe,
with actual and predicted classifications identified, and returns the
spec of the
predictions.}\label{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-and-returns-the-spec-of-the-predictions.}}

specificity = TN / (TN+FP)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{spec }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
  
\NormalTok{  conf }\OtherTok{=} \FunctionTok{table}\NormalTok{(data[ , predicted\_col\_name], data[ , actual\_col\_name])}
\NormalTok{  TP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{]}
\NormalTok{  TN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FP }\OtherTok{=}\NormalTok{ conf[}\DecValTok{2}\NormalTok{,}\DecValTok{1}\NormalTok{]}
\NormalTok{  FN }\OtherTok{=}\NormalTok{ conf[}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\#specificity= TN / (TN+FP)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{round}\NormalTok{((TN)}\SpecialCharTok{/}\NormalTok{(TN }\SpecialCharTok{+}\NormalTok{ FP), }\DecValTok{4}\NormalTok{))}
\NormalTok{\}}
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"specificity: "}\NormalTok{, }\FunctionTok{spec}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "specificity: 0.9597"
\end{verbatim}

\hypertarget{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-2}{%
\subsection{8. Write a function that takes the data set as a dataframe,
with actual and predicted classifications
identified,}\label{write-a-function-that-takes-the-data-set-as-a-dataframe-with-actual-and-predicted-classifications-identified-2}}

and returns the F1 score of the predictions.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f1\_score }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data, predicted\_col\_name, actual\_col\_name) \{}
\NormalTok{  p }\OtherTok{=} \FunctionTok{precision}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{) }
\NormalTok{  s }\OtherTok{=} \FunctionTok{sens}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)}
  \FunctionTok{return}\NormalTok{(}\DecValTok{2}\SpecialCharTok{*}\NormalTok{p}\SpecialCharTok{*}\NormalTok{s}\SpecialCharTok{/}\NormalTok{(p}\SpecialCharTok{+}\NormalTok{s))}
\NormalTok{\} }
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"F1 Score: "}\NormalTok{, }\FunctionTok{f1\_score}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "F1 Score: 0.606767453510436"
\end{verbatim}

\hypertarget{before-we-move-on-lets-consider-a-question-that-was-asked-what-are-the-bounds-on-the-f1-score-show-that-the-f1-score-will-always-be-between-0-and-1.-hint-if-0-ux1d44e-1-and-0-ux1d44f-1-then-ux1d44eux1d44f-ux1d44e.}{%
\subsection{9. Before we move on, let's consider a question that was
asked: What are the bounds on the F1 score? Show that the F1 score will
always be between 0 and 1. (Hint: If 0 \textless{} ùëé \textless{} 1 and 0
\textless{} ùëè \textless{} 1 then ùëéùëè \textless{}
ùëé.)}\label{before-we-move-on-lets-consider-a-question-that-was-asked-what-are-the-bounds-on-the-f1-score-show-that-the-f1-score-will-always-be-between-0-and-1.-hint-if-0-ux1d44e-1-and-0-ux1d44f-1-then-ux1d44eux1d44f-ux1d44e.}}

The F1 score is equivalent to the following:

\[
p = precision, s = Sensitivity
\]

\[
F1 = \frac{2*p*s}{p + s}
\]

Just by eye-balling this equation (and knowing that both precision and
Sensitivity are between 0 and 1), if we assume mutual exclusivity of
both metrics, F1 would simplify to the following:

\[
p = 1, s = 1
\\
F1 = \frac{2*1*1}{1+1} = 1
\]

To figure out the minimum values, we can take the derivative of F1 and
set it to zero. Since we have two metrics, we'll have to use partial
derivatives:

\[
dF1/dp = 2s^2/(p+s)^2
\]

\[
dF1/ds = 2p^2/(p+s)^2
\]

If we set both values at 0, then precision and Sensitivity would be at 0
for the zeroes of the function. If we go back and plug those values in,
F1 would be 0.

\hypertarget{section}{%
\subsection{10.}\label{section}}

Write a function that generates an ROC curve from a data set with a true
classification column (class in our example) and a probability column
(scored.probability in our example). Your function should return a list
that includes the plot of the ROC curve and a vector that contains the
calculated area under the curve (AUC). Note that I recommend using a
sequence of thresholds ranging from 0 to 1 at 0.01 intervals.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{getROCcurve }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(}\AttributeTok{col.true =} \StringTok{"class"}\NormalTok{, }\AttributeTok{col.probability =} \StringTok{"scored.probability"}\NormalTok{, data) \{}
\NormalTok{  vec.TPR }\OtherTok{=} \FunctionTok{c}\NormalTok{()}
\NormalTok{  vec.TNR }\OtherTok{=} \FunctionTok{c}\NormalTok{()}

  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{0.01}\NormalTok{)) \{}
\NormalTok{    data }\OtherTok{=}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{mutate}\NormalTok{(}\AttributeTok{model.classification =} \FunctionTok{ifelse}\NormalTok{(}\FunctionTok{unlist}\NormalTok{(}\FunctionTok{select}\NormalTok{(data, col.probability)) }\SpecialCharTok{\textless{}}\NormalTok{ i, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{    i.vec.TP }\OtherTok{=}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(model.classification }\SpecialCharTok{==}\NormalTok{ class }\SpecialCharTok{\&}\NormalTok{ class }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\NormalTok{    i.vec.FN }\OtherTok{=}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(model.classification }\SpecialCharTok{!=}\NormalTok{ class }\SpecialCharTok{\&}\NormalTok{ class }\SpecialCharTok{==} \DecValTok{1}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\NormalTok{    i.vec.TN }\OtherTok{=}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(model.classification }\SpecialCharTok{==}\NormalTok{ class }\SpecialCharTok{\&}\NormalTok{ class }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
\NormalTok{    i.vec.FP }\OtherTok{=}\NormalTok{ data }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(model.classification }\SpecialCharTok{!=}\NormalTok{ class }\SpecialCharTok{\&}\NormalTok{ class }\SpecialCharTok{==} \DecValTok{0}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{nrow}\NormalTok{()}
    
\NormalTok{    vec.TPR }\OtherTok{=} \FunctionTok{c}\NormalTok{(vec.TPR, (i.vec.TP}\SpecialCharTok{/}\NormalTok{(i.vec.TP }\SpecialCharTok{+}\NormalTok{ i.vec.FN)))}
\NormalTok{    vec.TNR }\OtherTok{=} \FunctionTok{c}\NormalTok{(vec.TNR, (i.vec.TN}\SpecialCharTok{/}\NormalTok{(i.vec.TN }\SpecialCharTok{+}\NormalTok{ i.vec.FP)))}

\NormalTok{  \}}
\NormalTok{  df.ROC }\OtherTok{=} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{Threshold =} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\FloatTok{0.01}\NormalTok{), }\AttributeTok{TNR =}\NormalTok{ vec.TNR, }\AttributeTok{TPR =}\NormalTok{ vec.TPR)}
\NormalTok{  df.ROC }\OtherTok{=}\NormalTok{ df.ROC }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{arrange}\NormalTok{(TNR, }\AttributeTok{decreasing =}\NormalTok{ T)}
\NormalTok{  plt.ROC }\OtherTok{=} \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =} \DecValTok{1}\SpecialCharTok{{-}}\NormalTok{(TNR), }\AttributeTok{y =}\NormalTok{ (TPR)), }\AttributeTok{data =}\NormalTok{ df.ROC) }\SpecialCharTok{+} \FunctionTok{geom\_step}\NormalTok{() }\SpecialCharTok{+} \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"1 {-} specificity"}\NormalTok{, }\AttributeTok{y =} \StringTok{"Sensitivity"}\NormalTok{)}
\NormalTok{  df.AUC  }\OtherTok{=}\NormalTok{ df.ROC }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{distinct}\NormalTok{(TPR, TNR)}
  
\NormalTok{  df.AUC }\OtherTok{\textless{}{-}}\NormalTok{ df.AUC }\SpecialCharTok{\%\textgreater{}\%}  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{TNR\_next =} \FunctionTok{lead}\NormalTok{(TNR, }\AttributeTok{n =}\NormalTok{ 1L))  }
\NormalTok{  df.AUC}\SpecialCharTok{$}\NormalTok{width }\OtherTok{=}\NormalTok{ df.AUC}\SpecialCharTok{$}\NormalTok{TNR\_next }\SpecialCharTok{{-}}\NormalTok{ df.AUC}\SpecialCharTok{$}\NormalTok{TNR}
\NormalTok{  vec.AUC }\OtherTok{=} \FunctionTok{sum}\NormalTok{(df.AUC}\SpecialCharTok{$}\NormalTok{width }\SpecialCharTok{*}\NormalTok{ df.AUC}\SpecialCharTok{$}\NormalTok{TPR, }\AttributeTok{na.rm =}\NormalTok{ T)}
  \FunctionTok{return}\NormalTok{(}\FunctionTok{list}\NormalTok{(}\StringTok{"AUC"} \OtherTok{=}\NormalTok{ vec.AUC, }\StringTok{"ROC"} \OtherTok{=}\NormalTok{ plt.ROC))}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{section-1}{%
\subsection{11.}\label{section-1}}

Use your created R functions and the provided classification output data
set to produce all of the classification metrics discussed above.

\hypertarget{accuracy}{%
\subsubsection{Accuracy}\label{accuracy}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Accuracy: "}\NormalTok{, }\FunctionTok{accuracy}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Accuracy: 0.8066"
\end{verbatim}

\hypertarget{error-rate}{%
\subsubsection{Error rate}\label{error-rate}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Error rate: "}\NormalTok{, }\FunctionTok{errorRate}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Error rate: 0.1934"
\end{verbatim}

\hypertarget{precision}{%
\subsubsection{Precision}\label{precision}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"Precision: "}\NormalTok{, }\FunctionTok{precision}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Precision: 0.8438"
\end{verbatim}

\hypertarget{sensitivityrecall}{%
\subsubsection{Sensitivity/Recall}\label{sensitivityrecall}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"sensitivity: "}\NormalTok{, }\FunctionTok{sens}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "sensitivity: 0.4737"
\end{verbatim}

\hypertarget{specificity}{%
\subsubsection{specificity}\label{specificity}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"specificity: "}\NormalTok{, }\FunctionTok{spec}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "specificity: 0.9597"
\end{verbatim}

\hypertarget{f1-score}{%
\subsubsection{F1 Score}\label{f1-score}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{paste0}\NormalTok{(}\StringTok{"F1 Score: "}\NormalTok{, }\FunctionTok{f1\_score}\NormalTok{(data, }\StringTok{\textquotesingle{}scored.class\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}class\textquotesingle{}}\NormalTok{)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "F1 Score: 0.606767453510436"
\end{verbatim}

\hypertarget{roc-curve}{%
\subsubsection{ROC Curve}\label{roc-curve}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{getROCcurve}\NormalTok{(}\AttributeTok{data =}\NormalTok{ data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Note: Using an external vector in selections is ambiguous.
## i Use `all_of(col.probability)` instead of `col.probability` to silence this message.
## i See <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.
## This message is displayed once per session.
\end{verbatim}

\begin{verbatim}
## $AUC
## [1] 0.8539898
## 
## $ROC
\end{verbatim}

\includegraphics{hw2-tora_files/figure-latex/unnamed-chunk-10-1.pdf}
\#\# 12. Investigate the carat package. In particular, consider the
functions confusionmatrix, sensitivity, and specificity. Apply the
functions to the data set. How do the results compare with your own
functions?

all of the results that we calculated above for the confusion matrix,
sensitivity, and specificity match the values givin by the matching
functions as shown below.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{scored}\OtherTok{\textless{}{-}}\FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{scored.class)}
\NormalTok{tclass}\OtherTok{\textless{}{-}}\FunctionTok{as.factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{class)}

\FunctionTok{confusionMatrix}\NormalTok{(scored, tclass)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Confusion Matrix and Statistics
## 
##           Reference
## Prediction   0   1
##          0 119  30
##          1   5  27
##                                           
##                Accuracy : 0.8066          
##                  95% CI : (0.7415, 0.8615)
##     No Information Rate : 0.6851          
##     P-Value [Acc > NIR] : 0.0001712       
##                                           
##                   Kappa : 0.4916          
##                                           
##  Mcnemar's Test P-Value : 4.976e-05       
##                                           
##             Sensitivity : 0.9597          
##             Specificity : 0.4737          
##          Pos Pred Value : 0.7987          
##          Neg Pred Value : 0.8438          
##              Prevalence : 0.6851          
##          Detection Rate : 0.6575          
##    Detection Prevalence : 0.8232          
##       Balanced Accuracy : 0.7167          
##                                           
##        'Positive' Class : 0               
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sensitivity}\NormalTok{(scored, tclass)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.9596774
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{specificity}\NormalTok{(scored, tclass)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4736842
\end{verbatim}

\hypertarget{section-2}{%
\subsection{13.}\label{section-2}}

investigate the pROc package. use it to generate an ROC curve for the
data set. How do the results compare with your own function.

altogether our two ROC curves are very close to one another. Both curves
show a nonlinear relationship showing our model is significantly better
then a randomized model aditionally both AUC measurements are close with
our handmade function having an AUC of 0.854 and the pROC function
having a AUC of 0.8503. Altogether both plots look very similar and
reflect that the model is a fairly good predictor of the data.both plots
look very similar.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{roc\_score}\OtherTok{=}\FunctionTok{roc}\NormalTok{(data, class, scored.probability,}\AttributeTok{plot=}\ConstantTok{TRUE}\NormalTok{) }\CommentTok{\#AUC score}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Setting levels: control = 0, case = 1
\end{verbatim}

\begin{verbatim}
## Setting direction: controls < cases
\end{verbatim}

\includegraphics{hw2-tora_files/figure-latex/unnamed-chunk-13-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ggroc(roc\_score)}
\FunctionTok{auc}\NormalTok{(roc\_score)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Area under the curve: 0.8503
\end{verbatim}

\end{document}
